<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Biggest Spreadsheet</title>

<style>
:root{
  --bg:#0b0f1a;
  --card:#111;
  --blue:#3b82f6;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif}
body{background:var(--bg);color:#fff;overflow-x:hidden}

/* Mouse Glow */
#mouse{
  position:fixed;width:280px;height:280px;
  background:radial-gradient(circle,rgba(59,130,246,.35),transparent 70%);
  pointer-events:none;transform:translate(-50%,-50%);
  z-index:0;
}

/* Header */
header{
  display:flex;justify-content:space-between;align-items:center;
  padding:15px 20px;background:#000;position:sticky;top:0;z-index:10
}
.menu{font-size:26px;cursor:pointer}
.title{font-size:22px;font-weight:bold;cursor:pointer}

/* Sidebar */
.sidebar{
  position:fixed;left:-260px;top:0;width:260px;height:100%;
  background:#111;padding:20px;transition:.3s;z-index:20
}
.sidebar.active{left:0}
.sidebar a{display:block;color:#fff;margin:10px 0;cursor:pointer}
.sidebar a:hover{color:var(--blue)}

/* Sort */
.sort{
  display:none;
  padding:10px 20px;
  text-align:right
}
.sort select{padding:6px;border-radius:6px}

/* Products */
.products{padding:20px;display:grid;gap:20px}

/* STARTSEITE */
.home.products{
  grid-template-columns:repeat(5,1fr)
}

/* KATEGORIE */
.category.products{
  grid-template-columns:repeat(5,1fr)
}

/* HANDY */
@media(max-width:900px){
  .home.products,
  .category.products{
    grid-template-columns:repeat(2,1fr)
  }
}

/* Product Card */
.product{
  background:var(--card);
  border-radius:14px;
  padding:15px;
  display:flex;
  flex-direction:column;
  height:100%;
  transition:.3s
}
.product:hover{box-shadow:0 0 25px rgba(59,130,246,.6)}
.product img{
  width:100%;height:200px;
  object-fit:contain;background:#000;border-radius:10px
}
.product h3{
  margin:10px 0;
  min-height:48px;
  text-align:center
}
.price{margin-bottom:10px;color:#ccc}
.buy{
  margin-top:auto;
  padding:10px;
  background:linear-gradient(90deg,#4f46e5,#9333ea);
  text-align:center;
  border-radius:10px;
  color:#fff;
  text-decoration:none;
  font-weight:bold
}

/* Load more */
.load{
  text-align:center;
  padding:30px;
  cursor:pointer;
  color:var(--blue);
  display:none
}
</style>
</head>

<body>

<div id="mouse"></div>

<header>
  <div class="menu" onclick="openMenu()">☰</div>
  <div class="title" onclick="showHome()">Biggest Spreadsheet</div>
</header>

<div class="sidebar" id="sidebar">
  <a onclick="showHome()">Startseite</a>
  <a onclick="showCategory('Schuhe')">Schuhe</a>
  <a onclick="showCategory('Jacke')">Jacke</a>
  <a onclick="showCategory('Sweater')">Sweater</a>
  <a onclick="showCategory('Pullover')">Pullover</a>
  <a onclick="showCategory('Hose')">Hose</a>
  <a onclick="showCategory('Jeans')">Jeans</a>
  <a onclick="showCategory('T-Shirts')">T-Shirts</a>
  <a onclick="showCategory('Shirts')">Shirts</a>
  <a onclick="showCategory('Accessoires')">Accessoires</a>
</div>

<div class="sort" id="sort">
  <select onchange="sortCategory(this.value)">
    <option value="new">Neueste</option>
    <option value="up">Preis ↑</option>
    <option value="down">Preis ↓</option>
  </select>
</div>

<div id="products" class="products"></div>
<div class="load" id="load" onclick="loadMore()">Mehr laden</div>

<script>
/* Mouse */
document.addEventListener("mousemove",e=>{
  mouse.style.left=e.clientX+"px"
  mouse.style.top=e.clientY+"px"
})

const SHEET_URL="https://docs.google.com/spreadsheets/d/e/2PACX-1vTKFDHf1iWbs3eMXQCWfu-DxXu8cKa-3k907m4M83DVJ3b3hMHt7co3z_w3LKwcRBkgOigcWRKZGgvC/pub?output=csv"

let all=[],view=[],cat="",shown=0

fetch(SHEET_URL).then(r=>r.text()).then(csv=>{
  const rows=csv.split("\n").slice(1)
  rows.forEach(r=>{
    const c=r.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g)
    if(!c) return
    all.push({
      name:c[0].replace(/"/g,""),
      price:parseFloat(c[1]),
      img:c[2].replace(/"/g,""),
      url:c[3].replace(/"/g,""),
      cat:c[4].replace(/"/g,"")
    })
  })
  showHome()
})

function render(list,type){
  const box=document.getElementById("products")
  box.className=`products ${type}`
  box.innerHTML=""
  list.forEach(p=>{
    box.innerHTML+=`
    <div class="product">
      <img src="${p.img}">
      <h3>${p.name}</h3>
      <div class="price">${p.price}€</div>
      <a class="buy" href="${p.url}" target="_blank">Jetzt kaufen</a>
    </div>`
  })
}

/* STARTSEITE */
function showHome(){
  cat=""
  sort.style.display="none"
  load.style.display="none"
  const newest=[...all].slice(-10)
  render(newest.reverse(),"home")
}

/* KATEGORIE */
function showCategory(c){
  cat=c
  sort.style.display="block"
  shown=20
  view=all.filter(p=>p.cat.toLowerCase()===c.toLowerCase())
  render(view.slice(0,shown),"category")
  load.style.display=view.length>shown?"block":"none"
}

/* LOAD MORE */
function loadMore(){
  shown+=20
  render(view.slice(0,shown),"category")
  load.style.display=view.length>shown?"block":"none"
}

/* SORT */
function sortCategory(t){
  let arr=[...view]
  if(t==="up") arr.sort((a,b)=>a.price-b.price)
  if(t==="down") arr.sort((a,b)=>b.price-a.price)
  if(t==="new") arr=arr
  render(arr.slice(0,shown),"category")
}

/* MENU */
function openMenu(){sidebar.classList.add("active")}
document.addEventListener("click",e=>{
  if(!sidebar.contains(e.target)&&!e.target.classList.contains("menu")){
    sidebar.classList.remove("active")
  }
})
</script>

</body>
</html>
