<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Biggest Spreadsheet</title>

<style>
*{box-sizing:border-box;margin:0;padding:0;font-family:Inter,Arial}
body{
  background:#050915;
  color:#fff;
  overflow-x:hidden;
}

/* === SIDE LIGHT EFFECT === */
body::before,body::after{
  content:"";
  position:fixed;
  top:0;bottom:0;
  width:90px;
  background:linear-gradient(180deg,transparent,#2f7cff,transparent);
  animation:flow 6s linear infinite;
  pointer-events:none;
}
body::after{right:0}
body::before{left:0}
@keyframes flow{0%{opacity:.2}50%{opacity:.9}100%{opacity:.2}}

/* === HEADER === */
header{
  padding:20px;
  text-align:center;
  font-size:26px;
  font-weight:800;
  cursor:pointer;
}

/* === CATEGORIES === */
#categories{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:10px;
  padding:10px;
}
.cat-btn{
  padding:10px 20px;
  border-radius:25px;
  background:linear-gradient(90deg,#2f7cff,#6a5cff);
  box-shadow:0 0 15px #2f7cff;
  cursor:pointer;
}

/* === SORT === */
#sortBox{
  display:none;
  text-align:right;
  padding:10px 20px;
}
select{
  background:#0d1a3a;
  color:#fff;
  padding:8px;
  border:none;
  border-radius:10px;
}

/* === GRIDS === */
.grid{display:grid;gap:20px;padding:20px}
.start-grid{grid-template-columns:repeat(5,1fr)}
.cat-grid{grid-template-columns:repeat(4,1fr)}

/* === CARD === */
.card{
  background:#0d1a3a;
  border-radius:18px;
  padding:14px;
  display:flex;
  flex-direction:column;
  height:100%;
  box-shadow:0 0 20px rgba(47,124,255,.3);
}
.card:hover{box-shadow:0 0 40px #2f7cff}
.img{
  height:200px;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
}
.img img{max-height:100%;max-width:100%;object-fit:contain}
.new{
  position:absolute;
  top:8px;left:8px;
  background:#2f7cff;
  padding:4px 8px;
  border-radius:6px;
  font-size:12px;
}
.name{min-height:36px;margin-top:8px}
.price{margin-top:auto;font-weight:700}
.buy{
  margin-top:12px;
  padding:10px;
  border-radius:10px;
  background:linear-gradient(90deg,#2f7cff,#6a5cff);
  text-align:center;
  text-decoration:none;
  color:#fff;
}

/* === LOAD MORE === */
#loadMore{
  display:none;
  margin:30px auto;
  padding:12px 30px;
  border-radius:30px;
  background:#2f7cff;
  border:none;
  color:#fff;
}

/* === MOBILE === */
@media(max-width:900px){
  .start-grid{grid-template-columns:repeat(2,1fr)}
  .cat-grid{grid-template-columns:repeat(2,1fr)}
}
</style>
</head>

<body>

<header onclick="goHome()">Biggest Spreadsheet</header>

<div id="categories"></div>

<div id="home">
  <div class="grid start-grid" id="homeGrid"></div>
</div>

<div id="category" style="display:none">
  <div id="sortBox">
    <select onchange="setSort(this.value)">
      <option value="new">Neueste</option>
      <option value="up">Preis ↑</option>
      <option value="down">Preis ↓</option>
    </select>
  </div>
  <div class="grid cat-grid" id="catGrid"></div>
  <button id="loadMore" onclick="loadMore()">Mehr laden</button>
</div>

<script>
const CSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vTKFDHf1iWbs3eMXQCWfu-DxXu8cKa-3k907m4M83DVJ3b3hMHt7co3z_w3LKwcRBkgOigcWRKZGgvC/pub?output=csv";
let products=[],currentCat="",offset=0,sort="new";

fetch(CSV).then(r=>r.text()).then(t=>{
 t.split("\n").slice(1).forEach(r=>{
  const [name,price,image,link,category,date]=r.split(",");
  products.push({name,price:+price,image,link,category,date:new Date(date)});
 });
 renderCategories();
 renderHome();
});

function renderCategories(){
 const cats=[...new Set(products.map(p=>p.category))];
 document.getElementById("categories").innerHTML=
 cats.map(c=>`<div class="cat-btn" onclick="openCat('${c}')">${c}</div>`).join("");
}

function card(p){
 const isNew=(Date.now()-p.date)<72*3600000;
 return `
 <div class="card">
  <div class="img">
   <img src="${p.image}">
   ${isNew?'<div class="new">NEW</div>':""}
  </div>
  <div class="name">${p.name}</div>
  <div class="price">${p.price} €</div>
  <a class="buy" href="${p.link}" target="_blank">Jetzt kaufen</a>
 </div>`;
}

function renderHome(){
 document.getElementById("home").style.display="block";
 document.getElementById("category").style.display="none";
 document.getElementById("homeGrid").innerHTML=
 products.sort((a,b)=>b.date-a.date).slice(0,10).map(card).join("");
}

function openCat(c){
 currentCat=c;offset=0;
 document.getElementById("home").style.display="none";
 document.getElementById("category").style.display="block";
 document.getElementById("sortBox").style.display="block";
 document.getElementById("catGrid").innerHTML="";
 loadMore();
}

function setSort(v){sort=v;offset=0;document.getElementById("catGrid").innerHTML="";loadMore()}

function loadMore(){
 let list=products.filter(p=>p.category===currentCat);
 if(sort==="new")list.sort((a,b)=>b.date-a.date);
 if(sort==="up")list.sort((a,b)=>a.price-b.price);
 if(sort==="down")list.sort((a,b)=>b.price-a.price);
 list.slice(offset,offset+20).forEach(p=>catGrid.innerHTML+=card(p));
 offset+=20;
 loadMore.style.display=offset<list.length?"block":"none";
}

function goHome(){renderHome()}
</script>

</body>
</html>
