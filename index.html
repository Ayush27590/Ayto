<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Biggest Spreadsheet</title>
<style>
:root{
  --bg:#0b0f1a;
  --card:#111;
  --white:#fff;
  --purple:#a855f7;
  --blue:#3b82f6;
  --ribbon-red:#f43f5e;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif;}
body{background:var(--bg);color:var(--white);overflow-x:hidden;position:relative;scroll-behavior:smooth;}

/* Mouse Glow */
#mouse-glow{
  position:fixed;width:300px;height:300px;
  background:radial-gradient(circle, rgba(59,130,246,0.35), transparent 70%);
  pointer-events:none;transform:translate(-50%,-50%);
  z-index:0;transition:transform 0.1s ease-out, opacity 0.3s ease-out;
  animation:glowPulse 2s infinite alternate;
}
@keyframes glowPulse{
  0%{opacity:0.3;}
  50%{opacity:0.6;}
  100%{opacity:0.3;}
}

/* Banner */
.banner{width:100%;overflow:hidden;background:linear-gradient(90deg,#4f46e5,#9333ea);white-space:nowrap;}
.banner-track{display:inline-block;padding-left:100%;animation:bannerMove 18s linear infinite;}
.banner a{color:#fff;text-decoration:none;font-weight:bold;font-size:16px;}
@keyframes bannerMove{0%{transform:translateX(0);}100%{transform:translateX(-100%);}}

/* Header */
header{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#000;position:sticky;top:0;z-index:10;box-shadow:0 2px 8px rgba(0,0,0,0.5);}
.menu-btn{font-size:26px;cursor:pointer;}
.title{font-size:22px;font-weight:bold;cursor:pointer;}
.header-right{display:flex;align-items:center;gap:8px;}
.header-right img{height:32px;border-radius:50%;}

/* Sidebar */
.sidebar{position:fixed;left:-260px;top:0;width:260px;height:100%;background:#111;padding:20px;transition:.3s;z-index:20;overflow-y:auto;}
.sidebar.active{left:0;}
.sidebar .close{font-size:22px;cursor:pointer;margin-bottom:20px;}
.sidebar a{display:block;color:#fff;text-decoration:none;font-size:18px;margin:10px 0;cursor:pointer;transition:.2s;}
.sidebar a:hover, .sidebar a.active{color:var(--blue);}

/* Search */
.search{padding:20px;text-align:center;}
.search input{width:90%;max-width:400px;padding:10px;border-radius:8px;border:none;}

/* Titles */
h2{padding:0 20px 10px;}

/* Products */
.products{padding:20px;gap:20px;justify-content:center;display:flex;flex-wrap:wrap;transition:all 0.3s ease;}
.products.horizontal{display:flex;overflow-x:auto;scroll-snap-type:x mandatory;gap:20px;padding-left:20px;scroll-behavior:smooth;}
.products.horizontal .product{scroll-snap-align:center;}
.products.grid{display:grid;gap:20px;transition:all 0.3s ease;}

@media(max-width:480px){
  .products.grid {
    grid-template-columns:repeat(2, 1fr);
    gap:10px;
  }
  .product {
    width:100%;
    max-width:calc(50% - 10px);
  }
}


/* Product card */
.product{
  background:var(--card);border-radius:14px;padding:15px;display:flex;flex-direction:column;align-items:center;
  position:relative;width:260px;opacity:0;
  transition:transform 0.3s ease, box-shadow 0.3s ease;
}
.product.animate{animation:fadeInUp 0.6s forwards;}
.product:hover, .product:active{transform:translateY(-8px);box-shadow:0 0 25px rgba(59,130,246,.6);}
.product img{width:100%;height:200px;object-fit:contain;background:#000;border-radius:10px;transition:transform 0.3s;}
.product:hover img{transform:scale(1.05);}
.product h3{margin:10px 0;text-align:center;min-height:44px;}
.product .price{margin-bottom:10px;color:#ccc;min-height:24px;}
.buy-btn{
  margin-top:auto;width:100%;text-align:center;padding:10px;border-radius:10px;
  background:linear-gradient(90deg,#4f46e5,#9333ea);
  color:#fff;text-decoration:none;font-weight:bold;
  transition:all 0.3s ease;
}
.buy-btn:hover{background:linear-gradient(90deg,#9333ea,#4f46e5);transform:scale(1.05);}

/* NEW Ribbon */
.new-ribbon{
  position:absolute;top:10px;right:10px;
  background:var(--ribbon-red);color:#fff;font-size:12px;font-weight:bold;padding:3px 7px;
  border-radius:5px;animation:pulseNew 1.5s infinite;
}
@keyframes pulseNew{
  0%{transform:scale(1);opacity:1;}
  50%{transform:scale(1.1);opacity:0.8;}
  100%{transform:scale(1);opacity:1;}
}

/* Load more */
.load-more{text-align:center;color:var(--purple);font-size:20px;cursor:pointer;margin:30px;display:none;transition:all 0.3s;}
.load-more:hover{color:var(--blue);}

/* Animations */
@keyframes fadeInUp{
  0%{opacity:0;transform:translateY(20px);}
  100%{opacity:1;transform:translateY(0);}
}

/* Sort Dropdown */
.sort-container{position:fixed;top:80px;right:20px;z-index:15;}
.sort-select{padding:8px 12px;border-radius:6px;border:none;font-weight:bold;background:#222;color:#fff;cursor:pointer;}
</style>
</head>
<body>
<div id="mouse-glow"></div>

<div class="banner">
  <div class="banner-track">
    <a href="https://www.acbuy.com/signup" target="_blank">
      Sign up to ACBuy & get $510 coupon • Sign up to ACBuy & get $510 coupon •
    </a>
  </div>
</div>

<header>
  <div class="menu-btn" onclick="openMenu()">☰</div>
  <div class="title" onclick="goHome()">Biggest Spreadsheet</div>
  <div class="header-right">
    <img src="https://image2url.com/r2/bucket1/images/1766618106451-0c81d26c-b893-4839-bc66-6642677b99d6.jpg">
    <span>X</span>
    <img src="https://image2url.com/r2/bucket1/images/1766618736532-eaf2466a-02d4-42f9-974e-09096fe25b67.jpg">
  </div>
</header>

<div class="sidebar" id="sidebar">
  <div class="close" onclick="closeMenu()">✖</div>
  <a onclick="goHome()" id="cat-home">Startseite</a>
  <a onclick="showCategory('Schuhe')">Schuhe</a>
  <a onclick="showCategory('Jacke')">Jacke</a>
  <a onclick="showCategory('Sweater')">Sweater</a>
  <a onclick="showCategory('Pullover')">Pullover</a>
  <a onclick="showCategory('Hose')">Hose</a>
  <a onclick="showCategory('Jeans')">Jeans</a>
  <a onclick="showCategory('T-Shirts')">T-Shirts</a>
  <a onclick="showCategory('Shirts')">Shirts</a>
  <a onclick="showCategory('Accessoires')">Accessoires</a>
</div>

<div class="sort-container" id="sortContainer" style="display:none;">
  <select class="sort-select" onchange="sortCategory(this.value)">
    <option value="newest">Neueste zuerst</option>
    <option value="price-asc">Preis ↑</option>
    <option value="price-desc">Preis ↓</option>
  </select>
</div>

<div class="search">
  <input id="search" placeholder="Live Suche..." oninput="liveSearch()">
</div>

<h2 id="sectionTitle">New Products</h2>
<div class="products horizontal" id="products"></div>
<div class="load-more" id="loadMore" onclick="loadMoreProducts()">⬇ Mehr anzeigen</div>

<script>
const mouseGlow = document.getElementById("mouse-glow");
document.addEventListener("mousemove", e=>{
  mouseGlow.style.left=e.clientX+"px";
  mouseGlow.style.top=e.clientY+"px";
});

const sidebar = document.getElementById("sidebar");
function openMenu(){sidebar.classList.add("active");}
function closeMenu(){sidebar.classList.remove("active");}
document.addEventListener("click", e=>{
  if(!sidebar.contains(e.target) && !e.target.classList.contains('menu-btn')){closeMenu();}
});

const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTKFDHf1iWbs3eMXQCWfu-DxXu8cKa-3k907m4M83DVJ3b3hMHt7co3z_w3LKwcRBkgOigcWRKZGgvC/pub?output=csv";
let allProducts=[],currentCat="",visibleCount=20;

fetch(SHEET_URL)
.then(res=>res.text())
.then(csv=>{
  const rows = csv.trim().split("\n").slice(1);
  rows.forEach(row=>{
    const [name,price,image,link,category] = row.split(",");
    if(!name) return;
    allProducts.push({name:name.trim(),price:price.trim(),image:image.trim(),link:link.trim(),category:category.trim(),added:Date.now()});
  });
  showHome();
});

const container = document.getElementById("products");

function renderList(list,mode){
  container.className = mode==="horizontal"?"products horizontal":"products grid";
  container.innerHTML="";
  list.forEach((p,i)=>{
    const isNew = Date.now()-p.added<72*60*60*1000;
    const card = document.createElement('div');
    card.className='product';
    if(isNew) card.innerHTML+=`<div class="new-ribbon">NEW</div>`;
    card.innerHTML+=`<img src="${p.image}"><h3>${p.name}</h3><div class="price">${p.price}€</div>
    <a class="buy-btn" href="${p.link}" target="_blank">Jetzt kaufen</a>`;
    container.appendChild(card);
    setTimeout(()=>card.classList.add('animate'), i*100);
  });
}

function showHome(){
  document.getElementById("sectionTitle").innerText="New Products";
  const newest = allProducts.sort((a,b)=>b.added-a.added).slice(0,10);
  renderList(newest,"horizontal");
  loadMore.style.display="none";
  currentCat="";
  highlightCategory('');
  document.getElementById("sortContainer").style.display="none";
  closeMenu();
}

function showCategory(cat){
  document.getElementById("sectionTitle").innerText=cat;
  currentCat=cat;
  visibleCount=20;
  const filtered = allProducts.filter(p=>p.category.trim().toLowerCase()===cat.trim().toLowerCase());
  renderList(filtered.slice(0,visibleCount),"grid");
  loadMore.style.display = filtered.length>visibleCount?"block":"none";
  highlightCategory(cat);
  document.getElementById("sortContainer").style.display="block";
  closeMenu();
}

const loadMore = document.getElementById("loadMore");
function loadMoreProducts(){
  visibleCount += 20;
  const filtered = allProducts.filter(p=>p.category.trim().toLowerCase()===currentCat.trim().toLowerCase());
  renderList(filtered.slice(0,visibleCount),"grid");
  loadMore.style.display = filtered.length>visibleCount?"none":"block";
}

function liveSearch(){
  const q = document.getElementById("search").value.toLowerCase();
  const filtered = allProducts.filter(p=>p.name.toLowerCase().includes(q) || p.category.toLowerCase().includes(q));
  renderList(filtered,"grid");
}

function sortCategory(value){
  const filtered = allProducts.filter(p=>p.category.trim().toLowerCase()===currentCat.trim().toLowerCase());
  let sorted;
  if(value==="newest"){sorted = filtered.sort((a,b)=>b.added-a.added);}
  else if(value==="price-asc"){sorted = filtered.sort((a,b)=>parseFloat(a.price)-parseFloat(b.price));}
  else if(value==="price-desc"){sorted = filtered.sort((a,b)=>parseFloat(b.price)-parseFloat(a.price));}
  renderList(sorted.slice(0,visibleCount),"grid");
}

function goHome(){showHome();}

function highlightCategory(cat){
  document.querySelectorAll('.sidebar a').forEach(a=>{
    a.classList.remove('active');
    if(a.innerText.toLowerCase()===cat.toLowerCase()) a.classList.add('active');
  });
}
</script>
</body>
</html>
