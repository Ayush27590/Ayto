<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Biggest Spreadsheet</title>

<style>
:root{
  --bg:#0b0f1a;
  --card:#111;
  --white:#fff;
  --purple:#a855f7;
  --blue:#3b82f6;
  --ribbon-red:#f43f5e;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif;}
body{background:var(--bg);color:var(--white);overflow-x:hidden;}

/* Mouse Glow */
#mouse-glow{
  position:fixed;width:300px;height:300px;
  background:radial-gradient(circle, rgba(59,130,246,0.35), transparent 70%);
  pointer-events:none;transform:translate(-50%,-50%);
  z-index:0;
}

/* Header / Banner / Sidebar unverändert */
header{display:flex;justify-content:space-between;align-items:center;padding:15px 20px;background:#000;position:sticky;top:0;z-index:10;}
.menu-btn{font-size:26px;cursor:pointer;}
.title{font-size:22px;font-weight:bold;cursor:pointer;}

.sidebar{position:fixed;left:-260px;top:0;width:260px;height:100%;background:#111;padding:20px;transition:.3s;z-index:20;}
.sidebar.active{left:0;}
.sidebar a{display:block;color:#fff;text-decoration:none;font-size:18px;margin:10px 0;cursor:pointer;}
.sidebar a.active{color:var(--blue);}

/* Search */
.search{text-align:center;padding:15px;}
.search input{width:90%;max-width:400px;padding:10px;border-radius:8px;border:none}

/* Products */
.products.horizontal{display:flex;gap:20px;overflow-x:auto;padding:20px}
.products.grid{display:grid;gap:20px;padding:20px}

@media(max-width:768px){
  .products.grid{grid-template-columns:repeat(2,1fr)}
}
@media(min-width:769px){
  .products.grid{grid-template-columns:repeat(4,1fr)}
}

/* Product Card (NICHT VERÄNDERT) */
.product{
  background:var(--card);
  border-radius:14px;
  padding:15px;
  display:flex;
  flex-direction:column;
  align-items:center;
  position:relative;
}
.product img{width:100%;height:200px;object-fit:contain}
.product h3{text-align:center;margin:10px 0}
.price{color:#ccc;margin-bottom:10px}
.buy-btn{
  margin-top:auto;
  width:100%;
  padding:10px;
  border-radius:10px;
  background:linear-gradient(90deg,#4f46e5,#9333ea);
  color:#fff;
  text-decoration:none;
  text-align:center;
  font-weight:bold;
}

/* NEW */
.new{
  position:absolute;
  top:10px;
  right:10px;
  background:var(--ribbon-red);
  font-size:12px;
  padding:4px 7px;
  border-radius:5px;
}

/* Sortierung */
.sort-box{
  display:none;
  padding:0 20px;
  text-align:right;
}
.sort-box select{
  padding:6px;
  border-radius:6px;
}
</style>
</head>

<body>

<div id="mouse-glow"></div>

<header>
  <div class="menu-btn" onclick="openMenu()">☰</div>
  <div class="title" onclick="showHome()">Biggest Spreadsheet</div>
</header>

<div class="sidebar" id="sidebar">
  <a onclick="showHome()">Startseite</a>
  <a onclick="showCategory('Schuhe')">Schuhe</a>
  <a onclick="showCategory('Jacke')">Jacke</a>
  <a onclick="showCategory('Sweater')">Sweater</a>
</div>

<div class="search">
  <input placeholder="Live Suche..." oninput="liveSearch(this.value)">
</div>

<div class="sort-box" id="sortBox">
  <select onchange="sortCategory(this.value)">
    <option value="new">Neueste zuerst</option>
    <option value="priceUp">Preis ↑</option>
    <option value="priceDown">Preis ↓</option>
  </select>
</div>

<h2 id="sectionTitle">New Products</h2>
<div class="products horizontal" id="products"></div>

<script>
const SHEET_URL = "DEIN_SHEET_CSV_LINK";
let allProducts = [];
let currentCategory = "";

/* Mouse glow */
document.addEventListener("mousemove",e=>{
  document.getElementById("mouse-glow").style.left=e.clientX+"px";
  document.getElementById("mouse-glow").style.top=e.clientY+"px";
});

/* Sidebar */
function openMenu(){document.getElementById("sidebar").classList.add("active");}

/* Google Sheets – HEADER SAFE */
fetch(SHEET_URL).then(r=>r.text()).then(csv=>{
  const rows = csv.split("\n").filter(Boolean);
  const headers = rows[0].split(",").map(h=>h.toLowerCase().replace(/"/g,""));

  const idx = {
    name:headers.indexOf("name"),
    price:headers.indexOf("price"),
    image:headers.indexOf("image"),
    link:headers.indexOf("link"),
    category:headers.indexOf("category"),
    date:headers.indexOf("date")
  };

  rows.slice(1).forEach(r=>{
    const c = r.match(/(".*?"|[^",]+)(?=\s*,|\s*$)/g);
    if(!c) return;
    allProducts.push({
      name:c[idx.name]?.replace(/"/g,""),
      price:parseFloat(c[idx.price]),
      image:c[idx.image]?.replace(/"/g,""),
      link:c[idx.link]?.replace(/"/g,""),
      category:c[idx.category]?.replace(/"/g,""),
      date:new Date(c[idx.date]?.replace(/"/g,""))
    });
  });

  showHome();
});

/* Render */
function render(list,type){
  const box=document.getElementById("products");
  box.className="products "+(type==="start"?"horizontal":"grid");
  box.innerHTML="";

  const now=Date.now();
  list.forEach(p=>{
    const isNew = type==="start" && (now-p.date)<=72*3600000;
    box.innerHTML+=`
      <div class="product">
        ${isNew?'<div class="new">NEW</div>':''}
        <img src="${p.image}">
        <h3>${p.name}</h3>
        <div class="price">${p.price}€</div>
        <a class="buy-btn" href="${p.link}" target="_blank">Jetzt kaufen</a>
      </div>`;
  });
}

/* Startseite – 10 NEUESTE */
function showHome(){
  currentCategory="";
  document.getElementById("sortBox").style.display="none";
  document.getElementById("sectionTitle").innerText="New Products";

  const newest=[...allProducts].sort((a,b)=>b.date-a.date).slice(0,10);
  render(newest,"start");
}

/* Kategorie – ALLE */
function showCategory(cat){
  currentCategory=cat;
  document.getElementById("sortBox").style.display="block";
  document.getElementById("sectionTitle").innerText=cat;

  const list=allProducts.filter(p=>p.category.toLowerCase()===cat.toLowerCase());
  render(list,"category");
}

/* Sortieren */
function sortCategory(type){
  let list=[...allProducts].filter(p=>p.category.toLowerCase()===currentCategory.toLowerCase());
  if(type==="priceUp") list.sort((a,b)=>a.price-b.price);
  if(type==="priceDown") list.sort((a,b)=>b.price-a.price);
  if(type==="new") list.sort((a,b)=>b.date-a.date);
  render(list,"category");
}

/* Search */
function liveSearch(q){
  q=q.toLowerCase();
  render(allProducts.filter(p=>p.name.toLowerCase().includes(q)),"category");
}
</script>

</body>
</html>
